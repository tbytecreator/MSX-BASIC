00010 '=================================
00020 ' CALENDARIO PERMANENTE           
00030 ' tbytecreator 2024-12
00040 '=================================
00050 CLEAR:KEYOFF:COLOR15,4:SCREEN0
00055 WIDTH 35
00060 DIM M$(12) : ' NOME DOS MESES
00070 DIM F$(11) : ' FERIADOS
00080 GOSUB 9000 : ' CARREGA OS DADOS
00090 OPEN"GRP:"FOR OUTPUT AS #1
00100 LOCATE 7,1 
00105 PRINT"Calenderio permamente"
00110 LOCATE 4,6
00115 PRINT"TByteCreator 2024-12"
00120 LOCATE 3,5 
00125 INPUT"Digite o ano: ";AN
00130 IF AN < 1583 OR AN > 2499 THEN 8000 
00140 BI=0:IF AN/4 <> AN\4 THEN 170
00150 IF AN/400 = AN\400 THEN BI=1:GOTO 170
00160 IF AN/100 <> AN\100 THEN BI=1
00170 ND=365+BI:DIMD(ND),N(12),M(13)
00180 IF AN>=1583 AND AN<1700 THEN X=22:Y=2:GOTO 290
00190 FOR I=17 TO 24
00195   IF AN>=I*100 AND AN<(I+1)*100 THEN J=I-16:GOTO 210
00200 NEXT I
00210 ON J GOTO 220,230,240,250,260,270,280,290
00220 X=23:Y=3:GOTO 290
00230 X=23:Y=4:GOTO 290
00240 X=24:Y=5:GOTO 290
00250 X=24:Y=6:GOTO 290
00260 X=25:Y=0:GOTO 290
00270 X=26:Y=1:GOTO 290
00280 X=25:Y=1
00290 A=AN MOD 19
00300 B=AN MOD 4
00310 C=AN MOD 7
00320 D=(19*A+X) MOD 30
00330 E=(2*B+4*C+6*D+Y) MOD 7
00340 P=22+D+E
00350 IF P<=31 THEN P=59+BI+P:GOTO 380
00360 P=D+E-9:IF P<=25 THEN P=P+BI+90:GOTO 380
00370 P=P+83+BI
00380 CA=P-47:PA=P-2:CC=P+60

430 D1=PMOD7:IFD1=0THEND1=7
440 N(1)=9-D1:IFN(1)=8THENN(1)=1
450 N(2)=N(1)+3:IFN(2)>7THENN(2)=N(2)-7
460 N(3)=N(2)+BI:IFN(3)>7THENN(3)=N(3)-7
470 N(4)=N(3)+3:IFN(4)>7THENN(4)=N(4)-7
480 N(5)=N(4)+2:IFN(5)>7THENN(5)=N(5)-7
490 N(6)=N(5)+3:IFN(6)>7THENN(6)=N(6)-7
500 N(7)=N(6)+2:IFN(7)>7THENN(7)=N(7)-7
510 N(8)=N(7)+3:IFN(8)>7THENN(8)=N(8)-7
520 N(9)=N(8)+3:IFN(9)>7THENN(9)=N(9)-7
530 N(10)=N(9)+2:IFN(10)>7THENN(10)=N(10)-7
540 N(11)=N(10)+3:IFN(11)>7THENN(11)=N(11)-7
550 N(12)=N(11)+2:IFN(12)>7THENN(12)=N(12)-7
560 FOR I=D1 TO ND STEP 7:D(I)=12:NEXT
570 D(CA)=1:D(PA)=2:D(CC)=3
580 D(1)=4:D(111+BI)=5:D(121+BI)=6:D(250+BI)=7:D(258+BI)=8:D(306+BI)=9:D(319+BI)=10:D(359+BI)=11
590 LOCATE4,11:PRINT"(1 A 12)"
600 LOCATE3,10:INPUT"QUAL O MES";ME
610 IFME<1ORME>12ORME<>INT(ME)THENCOLOR15,8:CLS:LOCATE10,10:PRINT"DADO INVALIDO":FORU=1TO1000:NEXT:COLOR15,4:CLS:LOCATE7,1:PRINT"CALENDARIO PERMANENTE":LOCATE3,5:PRINT"ANO =";AN:GOTO590
620 COLOR15,1,1:SCREEN2
630 COLOR3:PSET(INT(255-8*(LEN(M$(ME))+8))/2,1),1:PRINT#1,M$(ME);" DE";AN
631 COLOR3:PSET(INT(256-8*(LEN(M$(ME))+8))/2,1),1:PRINT#1,M$(ME);" DE";AN
640 COLOR7:PSET(0,24),1:PRINT#1,"   DOM SEG TER QUA QUI SEX SAB  "
650 DATA0,31,59,90,120,151,181,212,243,273,304,334,365
660 RESTORE650
670 FORU=1TO13:READM(U):NEXT
680 Q=0:IF ME=2THEN Q=BI
690 S=0:IFME>2THENS=BI
700 COLOR14:PSET(0,40),1:FORU=1TON(ME)*4:PRINT#1," ";:NEXTU
710 FORI=M(ME)+1TOM(ME)+8-N(ME)
720 IFD(I+S)<>0THENCOLOR8:PRINT#1,I-M(ME);" ";:COLOR14:GOTO740
730 PRINT#1,I-M(ME);" ";
740 NEXTI
750 W=40:FORJ=ITOM(ME+1)+QSTEP7
760 W=W+17:PSET(0,W),1:PRINT#1,"   ";:IFJ-M(ME)<10THENPRINT#1," ";
770 FORK=JTOJ+6:IFK>M(ME+1)+QTHENGOTO800
780 IFD(K+S)<>0THENCOLOR8:PRINT#1,K-M(ME);:COLOR14:GOTO800
790 PRINT#1,K-M(ME);
800 IFK-M(ME)<9THENPRINT#1," ";
810 NEXTK
820 NEXTJ
830 W=W+16:PSET(0,W),1:COLOR3:PRINT#1,STRING$(32,223);
840 FORI=M(ME)+1TOM(ME+1)+Q
850 IFD(I)>0ANDD(I)<12THENW=W+10:PSET(30,W),1:COLOR13:PRINT#1,F$(D(I))
860 NEXTI
870 W=W+8:PSET(0,W),1:COLOR3:PRINT#1,STRING$(32,220);
880 PSET(22,180),1:COLOR3:PRINT#1,"[1]OUTRO ANO / [2]OUTRO MES"
890 A$=INKEY$
900 IFA$="1"THEN RUN
910 IFA$="2"THENGOTO930
920 GOTO890
930 COLOR15,4:SCREEN0:LOCATE7,1:PRINT"CALENDARIO PERMANENTE":LOCATE3,5:PRINT"ANO =";AN:GOTO590

08000 '=================================
08010 ' SUBROTINA DE ERRO
08020 '=================================
08030 COLOR 15,8:CLS:LOCATE 10,10
08040 PRINT"Ano invÃ¡lido!"
08050 FOR U=1 TO 100:NEXT:' ESPERA
08060 RUN

09000 '=================================
09010 ' CARREGA OS DADOS
09020 '=================================
09030 FOR U=1 TO 12
09040   READM$(U) : ' NOME DOS MESES
09050 NEXT
09060 FOR U=1 TO 11
09070   READF$(U) : ' FERIADOS
09080 NEXT
09060 RETURN

10000 '=================================
10010 ' DADOS
10020 '=================================
10030 DATA JANEIRO,FEVEREIRO,MARCO,ABRIL
10040 DATA MAIO,JUNHO,JULHO,AGOSTO
10050 DATA SETEMBRO,OUTUBRO,NOVEMBRO
10060 DATA DEZEMBRO
10070 DATA terca-CARNAVAL,sexta-PAIXAO
10080 DATA quinta-CORPUS CHRISTI
10090 DATA 1-ANO NOVO,21-TIRADENTES
10100 DATA 1-DIA DO TRABALHO
10110 DATA 1-INDEP.BRASIL
10120 DATA 12-N.SRA.APARECIDA,2-FINADOS
10130 DATA 15-PROCL.REPUBLICA,25-NATAL