00010 '=====================================
00020 ' CALENDARIO PERMANENTE           
00030 ' tbytecreator 2024-12
00040 '=====================================
00050 CLEAR:KEY OFF:COLOR 2,1,1:SCREEN 0
00055 WIDTH 40
00060 DIM M$(12) : ' NOME DOS MESES
00070 DIM F$(11) : ' FERIADOS
00075 DIM N(12),M(13)
00080 GOSUB 9000 : ' CARREGA OS DADOS
00090 OPEN"GRP:"FOR OUTPUT AS #1
00100 LOCATE 0,1
00105 PRINT"Calenderio permamente"
00110 LOCATE 0,2
00115 PRINT"TByteCreator 2024-12"
00120 LOCATE 0,3 
00125 INPUT"Qual o ano (de 1583 ate 2499)";AN
00130 IF AN < 1583 OR AN > 2499 THEN 8000 
00140 BI=0:IF AN/4 <> AN\4 THEN 170
00150 IF AN/400 = AN\400 THEN BI=1:GOTO 170
00160 IF AN/100 <> AN\100 THEN BI=1
00170 ND=365+BI:DIM D(ND)
00180 IF AN>=1583 AND AN<1700 THEN X=22:Y=2:GOTO 290
00190 FOR I=17 TO 24
00195   IF AN>=I*100 AND AN<(I+1)*100 THEN J=I-16:GOTO 210
00200 NEXT I
00210 ON J GOTO 220,230,240,240,250,260,270,280
00220 X=23:Y=3:GOTO 290
00230 X=23:Y=4:GOTO 290
00240 X=24:Y=5:GOTO 290
00250 X=24:Y=6:GOTO 290
00260 X=25:Y=0:GOTO 290
00270 X=26:Y=1:GOTO 290
00280 X=25:Y=1
00290 A=AN MOD 19
00300 B=AN MOD 4
00310 C=AN MOD 7
00320 D=(19*A+X) MOD 30
00330 E=(2*B+4*C+6*D+Y) MOD 7
00340 P=22+D+E
00350 IF P<=31 THEN P=59+BI+P:GOTO 380
00360 P=D+E-9:IF P<=25 THEN P=P+BI+90:GOTO 380
00370 P=P+83+BI
00380 CA=P-47:PA=P-2:CC=P+60
00390 D1=P MOD 7:IF D1=0 THEN D1=7
00400 N(1)=9-D1:IFN(1)=8THENN(1)=1
00410 N(2)=N(1)+3:IFN(2)>7THENN(2)=N(2)-7
00420 N(3)=N(2)+BI:IFN(3)>7THENN(3)=N(3)-7
00430 N(4)=N(3)+3:IFN(4)>7THENN(4)=N(4)-7
00450 N(5)=N(4)+2:IFN(5)>7THENN(5)=N(5)-7
00460 N(6)=N(5)+3:IFN(6)>7THENN(6)=N(6)-7
00470 N(7)=N(6)+2:IFN(7)>7THENN(7)=N(7)-7
00480 N(8)=N(7)+3:IFN(8)>7THENN(8)=N(8)-7
00490 N(9)=N(8)+3:IFN(9)>7THENN(9)=N(9)-7
00500 N(10)=N(9)+2:IFN(10)>7THENN(10)=N(10)-7
00510 N(11)=N(10)+3:IFN(11)>7THENN(11)=N(11)-7
00520 N(12)=N(11)+2:IFN(12)>7THENN(12)=N(12)-7
00530 FOR I=D1 TO ND STEP 7:D(I)=12:NEXT
00540 D(CA)=1:D(PA)=2:D(CC)=3
00550 D(1)=4:D(111+BI)=5:D(121+BI)=6:D(250+BI)=7:D(258+BI)=8:D(306+BI)=9:D(319+BI)=10:D(359+BI)=11
00560 GOSUB 5000
00570 '=================================
00580 ' DESENHA O CALENDARIO
00590 '=================================
00595 COLOR 15,1,1:SCREEN 2
00600 COLOR 3:PSET(INT(255-8*(LEN(M$(ME))+8))/2,1),1:PRINT#1,M$(ME);" DE";AN
00610 COLOR 3:PSET(INT(256-8*(LEN(M$(ME))+8))/2,1),1:PRINT#1,M$(ME);" DE";AN
00620 COLOR 7:PSET(0,24),1:PRINT#1,"   DOM SEG TER QUA QUI SEX SAB  "
00660 Q=0:IF ME=2 THEN Q=BI
00670 S=0:IF ME>2 THEN S=BI
00680 COLOR 14:PSET(0,40),1:FOR U=1 TO N(ME)*4:PRINT#1," ";:NEXT U
00690 FOR I=M(ME)+1 TO M(ME)+8-N(ME)
00700   IF D(I+S)<>0 THEN COLOR 8:PRINT#1,I-M(ME);" ";:COLOR 14:GOTO 720
00710   PRINT#1,I-M(ME);" ";
00720 NEXT I
00730 W=40
00735 FOR J= I TO M(ME+1)+Q STEP 7
00740   W=W+17:PSET(0,W),1:PRINT#1,"   ";:IFJ-M(ME)<10 THEN PRINT#1," ";
00750   FOR K=J TO J+6
00755     IF K>M(ME+1)+Q THEN GOTO 790
00760     IF D(K+S)<>0 THEN COLOR 8:PRINT#1,K-M(ME);:COLOR 14:GOTO 790
00780     PRINT#1,K-M(ME);
00790     IF K-M(ME)<9 THEN PRINT#1," ";
00800   NEXT K
00810 NEXT J
00820 W=W+16:PSET(0,W),1:COLOR3:PRINT#1,STRING$(32,223);
00830 FOR I=M(ME)+1 TO M(ME+1)+Q
00840 IF D(I)>0 AND D(I)<12 THEN W=W+10:PSET(30,W),1:COLOR 13:PRINT#1,F$(D(I))
00850 NEXT I
00860 W=W+8:PSET(0,W),1:COLOR 3:PRINT#1,STRING$(32,220);
00870 PSET(22,180),1:COLOR 3:PRINT#1,"[1]OUTRO ANO / [2]OUTRO MES"
00880 A$=INKEY$
00890 IF A$="1" THEN RUN
00900 IF A$="2" THEN GOTO 6000
00910 GOTO 880

05000 '=================================
05010 'PROMPT MES   
05020 '=================================
05530 LOCATE 0,4:INPUT"Qual o mes (1 A 12)";ME
05540 IF ME<1 OR ME>12 OR ME<>INT(ME) THEN 7000
05550 RETURN

06000 '=================================
06010 ' PROMPT OUTRO MES 
06020 '=================================
06030 COLOR 2,1:CLS
06040 LOCATE 1,6
06060 LOCATE 1,7
06070 PRINT"ANO ";AN : GOTO 560

07000 '=================================
07010 ' MES INVALIDO
07020 '=================================
07030 COLOR 15,8:CLS
07040 LOCATE 10,10:PRINT"Mes invalido!"
07050 FOR U=1 TO 1000:NEXT U
07060 GOTO 6000

08000 '=================================
08010 ' ANO INVALIDO
08020 '=================================
08030 COLOR 15,8:CLS:LOCATE 10,10
08040 PRINT"Ano invalido!"
08050 FOR U=1 TO 1000:NEXT U:' ESPERA
08060 RUN

09000 '=================================
09010 ' CARREGA OS DADOS
09020 '=================================
09030 RESTORE 10030
09035 FOR U=1 TO 12
09040   READ M$(U) : ' NOME DOS MESES
09050 NEXT
09060 FOR U=1 TO 11
09070   READ F$(U) : ' FERIADOS
09080 NEXT
09090 FOR U=1 TO 13
09100   READ M(U)
09110 NEXT
09120 RETURN

10000 '=================================
10010 ' DADOS
10020 '=================================
10030 DATA JANEIRO,FEVEREIRO,MARCO,ABRIL
10040 DATA MAIO,JUNHO,JULHO,AGOSTO
10050 DATA SETEMBRO,OUTUBRO,NOVEMBRO
10060 DATA DEZEMBRO
10070 DATA terca-CARNAVAL,sexta-PAIXAO
10080 DATA quinta-CORPUS CHRISTI
10090 DATA 1-ANO NOVO,21-TIRADENTES
10100 DATA 1-DIA DO TRABALHO
10110 DATA 1-INDEP.BRASIL
10120 DATA 12-N.SRA.APARECIDA,2-FINADOS
10130 DATA 15-PROCL.REPUBLICA,25-NATAL
10140 DATA 0,31,59,90,120,151,181,212,243,273,304,334,365