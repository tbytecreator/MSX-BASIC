0010 '*********************************'
0020 ' FORMULA 1                       '
0030 ' CONVERSAO DO JOGO DO ODYSSEY    '
0040 ' MANOEL NETO                     '
0050 ' 2025-12-24                      '
0060 '*********************************'
0070 DEFINT A-Z:KEY OFF:SCREEN 1,3:COLOR 15,1:CLS
0080 BLOAD"XBASIC.BIN",R
0090 DIM M$(10):DIM CL%(1):DIM IN%(4):DIM YC%(7)
0100 GOSUB 1000:'CARREGA FONTE
0110 GOSUB 2000:'TELA SELECT GAME
0120 GOSUB 3000:'CARREGA SPRITES
0130 DEFUSR1=&H41 : ' FUNCAO DESLIGA TELA
0140 DEFUSR2=&H44 : ' FUNCAO LIGA TELA
0150 XC=75:VC=8:'POS E VEL DO CARRO
0160 IN(0)=0:IN(1)=0:IN(2)=0 :' POS X E Y DO INIMIGO
0170 IN(3)=VC:IN(4)=VC :' VELOCIDADE DO INIMIGO
0180 PT=0:MC=1: ' PONTOS E MARCHA

0300 ' TELA INICIAL
0310 FOR I = 0 TO 16 STEP 4
0320    CL=1:LN=I:VPOKE &H1800+CL+LN*32,94
0330    CL=23:LN=I:VPOKE &H1800+CL+LN*32,94
0340 NEXT I
0350 PUT SPRITE 8,(XC,160),8,0
0360 LOCATE 22,3:PRINT "PONTOS"
0370 LOCATE 21,5:PRINT PT;
0380 LOCATE 22,7:PRINT "MARCHA"
0390 LOCATE 21,9:PRINT MC;
0400 GOSUB 5000:' ADICIONA INIMIGO
0410 CALL TURBO ON (IN(),YC(),PT)

0500 ' GAME LOOP
0510 ' LE TECLAS
0520 D=STICK(0)
0530 IF D=3 THEN XC=XC+16
0540 IF D=7 THEN XC=XC-16
0550 IF D=5 THEN VC=VC-4:MC=MC-1
0560 IF D=1 THEN VC=VC+4:MC=MC+1
0570 IF XC<=32 THEN XC=32
0580 IF XC>=150 THEN XC=150
0590 IF VC<=4 THEN VC=4
0600 IF VC>=40 THEN VC=40
0610 IF MC <=1 THEN MC=1
0620 IF MC >=8 THEN MC=8
0630 IF IN(3)<0 THEN IN(3)=VC*-1
0640 IF IN(3)>0 THEN IN(3)=VC
0650 IN(4)=VC

0700 ' METODO UPDATE 
0710 ' UPDATE DA CERCA 
0720 FOR I = 0 TO 16 STEP 4
0730    CL%(0)=CL%(0)+I:CL%(1)=CL%(1)+I
0740 NEXT I
0750 IN(1)=IN(1)+IN(3)
0760 IN(2)=IN(2)+IN(4)
0770 IF IN(1)<=32  THEN IN(1)=32:IN(3)=IN(3)*-1
0780 IF IN(1)>=138 THEN IN(1)=138:IN(3)=IN(3)*-1 
0790 ' CHECK COLISAO
0800 IF IN(2)>150 AND IN(1)+16>XC AND IN(1)<XC+16 THEN GOTO 7000

0800 ' DESENHA O FRAME
0810 'A=USR1(0) : ' DESLIGA A TELA 
0820 FOR I = 0 TO 16 STEP 4
0690    CL=CL%(0):LN=CL%(1):VPOKE &H1800+CL+LN*32,0
0700    CL=CL%(0):LN=CL%(1):VPOKE &H1800+CL+LN*32,0
0710    IF TIME MOD 2 =0 THEN LN=LN+4
0720    CL=1:VPOKE &H1800+CL+LN*32,94
0730    CL=23:VPOKE &H1800+CL+LN*32,94
0740 NEXT I
0860 PUT SPRITE 8,(XC,160),8,0
0870 PUT SPRITE 9,(IN(1),IN(2)),15,0
0880 'A=USR2(0) : ' LIGA A TELA
0890 CALL TURBO OFF
0900 IF TIME<2 THEN 900
0910 LOCATE 21,5:PRINT PT;
0920 LOCATE 21,9:PRINT MC;
0930 TIME=0:PT=PT+VC 
0940 GOTO 530:' GAME LOOP 

1000 ' CARREGA A FONTE DO ODYSSEY
1010 RESTORE 11000 
1020 ST=(ASC("A")*8)
1030 FOR I=0 TO 239
1040  READ R$
1050  VPOKE ST+I, VAL("&H"+R$)
1060 NEXT I
1070 RETURN

2000 ' FAZ A SPLASH SECREEN
2010 M$(0)="S":M$(1)="E":M$(2)="L"
2020 M$(3)="E":M$(4)="C":M$(5)="T" 
2030 M$(6)=" ":M$(7)="G":M$(8)="A"
2040 M$(9)="M":M$(10)="E"
2050 MX=7
2060 MY=10
2070 FOR I = 0 TO 10
2080   C=RND(-TIME)*15 
2090   IF C<2 THEN 2080 
2100   COLOR C,1 
2110   LOCATE MX,10 :PRINT M$(I);
2120   MX=MX+1
2130 NEXT I
2140 OP$=INPUT$(1)
2150 CLS
2160 RETURN

3000 ' CARREGA SPRITES 
3010 RESTORE 12000
3020 S=BASE(9)
3030 READ R$
3040 IF R$="*" THEN RETURN 
3050 VPOKE S,VAL("&H"+R$)
3060 S=S+1
3070 GOTO 3030

5000 ' ADICIONA OS INIMIGOS 
5010 IF TIME MOD 2 = 0 THEN DR=1 ELSE DR=0
5020 IF DR=1 THEN IN(1)=48 ELSE IN(1)=132
5030 IF DR=1 THEN IN(3)=VC ELSE IN(3)=VC*-1
5040 IN(4)=VC
5050 PUT SPRITE 9,(IN(1),IN(2)),15,0
5060 IN(0)=1
5070 RETURN

7000 ' FIM DO JOGO 
7010 ' SOM DA EXPLOSAO 
7020 FOR I=1 TO 3
7030   SOUND 1,RND(1)*31+1
7040   SOUND 2,RND(1)*31+1
7050   SOUND 6,31
7060   SOUND 7,&B10111000
7070   FOR J=1 TO 50:NEXT J
7080 NEXT I
7090 SOUND 6,0
7100 SOUND 7,&B10111111
7110 ' ANIMACAO EXPLOSAO 
7120 PUTSPRITE 8,(XC,160),6,1
7130 OP$=INPUT$(1)
7140 CLOSE #1
7150 GOTO 150

11000 ' FONTE GORDINHA 
11010 DATA 02,06,0E,1E,3E,76,E6,76,FE,CC,D8,FE,CC,D8,F0,E0
11020 DATA 7E,FC,C0,C0,C0,C0,FC,7E,FE,FE,CC,D8,F0,E0,C0,80
11030 DATA FE,FE,00,FE,FE,00,FE,FE,FF,FE,C0,FC,F8,C0,C0,80
11040 DATA 7E,FC,C0,C0,C2,C6,FE,7F,C6,C6,C6,FE,FE,C6,C6,84
11050 DATA 38,38,38,38,38,38,30,20,02,06,06,06,06,06,7E,FE
11060 DATA CE,DC,F8,F0,F8,DC,CE,86,40,C0,C0,C0,C0,C0,FE,FC
11070 DATA 82,C6,EE,FE,FE,D6,C6,C6,C6,E6,F6,FE,DE,CE,C6,42
11080 DATA 7C,FE,C6,C6,C6,C6,FE,7C,FC,FE,06,FE,FC,C0,C0,80
11090 DATA 7C,FE,C6,C6,D6,FE,7C,10,C8,DC,CE,DC,F8,DC,CE,86
11100 DATA FE,FE,80,FE,FE,02,FE,FE,FE,FC,30,30,30,30,30,20
11110 DATA 82,C6,C6,C6,C6,C6,FE,7C,03,06,CC,D8,F0,E0,C0,80
11120 DATA C6,C6,D6,FE,FE,EE,C6,82,86,CE,FC,78,3C,7E,E6,C2
11130 DATA 87,CE,FC,78,30,30,30,20,7E,FE,1C,38,70,E0,FE,FC
11140 DATA 00,00,03,03,03,03,03,03,03,03,03,03,03,03,00,00
11150 DATA 00,00,C0,C0,C0,C0,C0,C0,C0,C0,C0,C0,C0,C0,00,00

12000 ' SPRITES 
12010 ' --- Slot 0 : carrinho
12020 ' color 8
12030 DATA 0F,0F,3F,3F,3F,3F,0F,0F,0C,0C,FF,FF,FF,FF,3F,3F
12040 DATA E0,E0,F8,F8,F8,F8,E0,E0,60,60,FF,FF,FF,FF,FC,FC
12090 DATA *