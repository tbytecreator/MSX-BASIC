1000 CLS:?"Monitor MSX 1986":?"Milton Maldonado Jr.":?"Modificado por Manoel Neto 2022-12-19"
1001 ?"Comandos: (D)ump &HXXXX, (M)odify &HXXXX,(L)oad XXXX (EM DECIMAL)"
1010 ?:LINE INPUT">";A$:IF LEN(A$)=0 THEN 1010
1020 C$=MID$(A$,1,1):IF C$="L"THEN 1130 ELSE IF C$="D" THEN 1030 ELSE IF C$="M" THEN 1060 ELSE BEEP:?"?";:GOTO 1010
1030 E=VAL(MID$(A$,2))
1040 FOR J=1 TO 8
1041   ? RIGHT$("0000"+HEX$(E),4);" ";
1042   FOR I=0 TO 7
1043     ? RIGHT$("00"+HEX$(PEEK(I+E)),2);" ";
1044   NEXT I
1045   ?
1046   E=E+8
1047 NEXT J
1050 I$ =INPUT$(1):IF I$=CHR$(27) THEN 1010 ELSE ?:GOTO 1040
1060 E=VAL(MID$(A$,2))
1070 ?:? RIGHT$("0000"+HEX$(E),4);" ";RIGHT$("00"+HEX$(PEEK(E)),2);" ";
1080 H$="":FOR I = 1 TO 2
1090 I$=INPUT$(1):IF I=1 THEN IF I$=CHR$(13) THEN E=E+1 GOTO 1070 ELSE IF I$=CHR$(8) THEN E=E-1:GOTO 1070
1100 IF I$=CHR$(27) THEN ?:GOTO 1010
1110 IF I$>="0" AND I$<="9" OR I$>="A" AND I$<="F" THEN 1120 ELSE 1090
1120 H$=H$+I$:? I$:NEXT I:POKE E,VAL("&H"+H$):E=E+1:GOTO 1070
1130 E=VAL(MID$(A$,2))
1140 RESTORE:FOR I=0 TO 7:READ A$(I),B$(I):NEXT I
1141 FOR I=0 TO 3:READ C$(I),E$(I):NEXT I
1142 FOR I=0 TO 7:READ D$(I),F$(I):NEXT I
1143 READ G$(0),G$(1),G$(2),H$(0),H$(1),H$(2),I$(0),I$(1),J$(0),J$(1)
1150 FOR K=1 TO 20:C=PEEK(E)
1160 ? USING "#####";E;:? " ";:GOSUB 1190:IF F>0 THEN I=I+1
1170 ? TAB(22);:FOR X=0 TO I-1:I$=HEX$(PEEK(X+E)):IF LEN(I$)<2 THEN I$="0"+I$
1180 ? I$;" ";:NEXT X:?:E=E+1:NEXT K:?:I$=INPUT$(1):IF I$=CHR$(27) THEN 1010 ELSE 1150 
1190 REM SEPARA OS GRUPOS 
1200 F=0:IF C=221 THEN F=1 ELSE IF C=253 THEN F2
1210 C$(2)="HL":IF F=1 THEN C$(2)="IX" ELSE IF F=2 THEN C$(2)="IY"
1220 IF C=203 THEN 1740 ELSE IF C=237 THEN 1800
1230 IF F>0 AND PEEK(E+1)=203 THEN 1740 
1240 IF F>0 THEN C=PEEK(E+1)
1250 REM COMANDOS DIRETOS 
1260 E$(2)=C$(2)
1270 I=1
1271 IF C=39 THEN ? "DAA"; ELSE IF C=47 THEN ? "CPL"; ELSE IF C=249 THEN ? "LD SP,";C$(2); ELSE IF C=227 THEN ? "EX (SP),";C$(2); ELSE IF C=118 THEN ? "HALT"; ELSE IF C=201 THEN ? "RET";ELSE IF C=31 THEN ? "RRA";ELSE 1290
1280 RETURN 
1290 IF C=235 THEN ? "EX DE,HL";ELSE IF C=8 THEN ? "EX AF,AF";ELSE IF C=217 THEN ? "EXX";ELSE IF C=233 THEN ? "JP(";C$(2);")"ELSE IF C=243 THEN ? "DI";ELSE IF C=251 THEN ? "EI";ELSE 1310
1300 RETURN
1310 IF C=7 THEN ? "RLCA";ELSE IF C=15 THEN ? "RRCA";ELSE IF C=23 THEN ? "RLA";ELSE IF C=55 THEN ? "SCF";ELSE IF C=63 THEN ? "CCF";ELSE 1330
1320 RETURN 
1330 I=2
1331 IF C=211 THEN ? "OUT(";:GOSUB 1610:?"),A" ELSE IF C=219 THEN ? "IN A,(";:GOSUB 1610:?")" ELSE 1350
1340 RETURN 
1350 IF C=195 THEN ? "JP ";ELSE IF C=205 THEN ?"CALL ";ELSE 1380
1360 ?MID$(STR$(PEEK (E+1)+256*PEEK (E+2)),2,5);:I=3:RETURN
1370 RETURN
1380 IF C=16 THEN ?"DJNZ";ELSE IF C=24 THEN ?"JR ";ELSE 1410
1390 X=PEEK(E+1):IF X<120 THEN Y=E+X+2 ELSE Y=E+X+254
1400 ? MID$(STR$(Y),2,5);:I=2:RETURN 
1410 IF C>127 AND C<192 THEN X=C\8-16:Y=C MOD 8:PRINT A$(X);:IF X=0 OR X=1 OR X=3 THEN ?" A,";ELSE PRINT" " ELSE 1430 
1420 PRINT B$(Y);:I=1:RETURN 
1430 IF C\64>0 THEN 1570
1440 IF C=34 THEN E=E+SGN(F):?"LD (";:GOSUB 1360:?"),";C$(2);:ELSE IF C=42 THEN E=E+SFN(F):?"LD ";C$(2);",(";:GOSUB 1360:?")";:ELSE 1460
1450 E=E-SGN(F):RETURN
1460 IF C=50 THEN ?"LD (";:GOSUB 1360:?"),A";ELSE IF C=58 THEN PRINT"LD A,(";:GOSUB 1360:?")";:RETURN ELSE 1480
1470 I=3:RETURN 
1480 X=C MOD 8:IF X=4 THEN PRINT "INC";ELSE IF X=5 THEN PRINT "DEC";ELSE 1500
1490 Y=C\8:PRINT " ";B$(Y);:I=1:RETURN 
1500 X=C MOD 16:IF X=3 THEN ?"INC ";ELSE IF X=11 THEN PRINT "DEC ";ELSE IF X=9 THEN ?"ADD ";C$(2);",";ELSE 1520 
1530 IF C MOD 16=1 THEN E=E+SGN(F):?"LD ";C$(C\16);",";:GOSUB 1360 ELSE 1550
1540 E=E-SGN(F):RETURN 
1550 IF C MOD 16=2 THEN PRINT "LD (";C$(C\16);"),A";ELSE IF C MOD 16=10 THEN ?"LD A,(";C$(C\16);")";ELSE 1570
1560 I=1:RETURN 
1570 IF C\32=1 AND C MOD 8=0 THEN ?"JR ";D$(C\8-4);",";:GOTO 1390
1580 IF C\64<>3 THEN 1680
1590 IF C MOD 8<>6 THEN 1620 
1600 I=2:X=C\8-24:?A$(X);" ";IF X<2 OR X=3 THEN ?"A,";
1610 ?MID$(STR$(PEEK(E+1)),2,3);:RETURN
1620 X=C MOD 8:IF X=1 THEN ?"POP ";E$(C\16-12);ELSE IF X=5 THEN ?"PUSH ";E$(C\16-12);
1630 IF X=1 OR X=5 THEN I=1:RETURN 
1640 IF X=7 THEN ?"RST ";HEX$(C-199);"H";:I=1:RETURN
1970 REM DADOS DA MATRIZ ALFA 
1980 DATA ADD,B,ADC,C,SUB,D,SBC,E,AND,H,XOR,L,OR,(HL),CP,A
1990 DATA BC,BC,DE,DE,HL,HL,SP,AF
2000 DATA NZ,RLC,Z,RRC,NC,RL,C,RR,PO,SL,A,PE,SRA,P,SLI,M,SRL
2010 DATA BIT,RES,SET 
2020 DATA LD,CP,IN,I,D, ,R 