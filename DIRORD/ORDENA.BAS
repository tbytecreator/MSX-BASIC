10 ' Ordenador de Diretorio
20 ' Aldo Barduco Junior -88
30 DEFSNG A-Z
B0 CLEAR 5000,&HBFFF:WIDTH 38
90 DIM N$(112),N(112):KEY OFF
100 KEY 1,SPACE$(6):KEY 6,SPACE$(6)
110 KEY 2,"   ###":KEY 7,"   ###"
120 KEY 3,"TECLE ":KEY 8, "TECLE "
160 kEY 4,"ENTER ":KEY 9, "ENTER "
140 KEY 5,"###":KEY 10,"###"
150 COLOR 14,1, 1
170 ' TRAVA CAPS LOCK
190 POKE &HFCAB,&H30
200 GOSUB 890
210 I$=INKEY$
220 IF I$<"A" OR I$>"B" THEN 210
230 PRINT I$
240 PRINT SPACE$(8);"LENDO DIRETORIO"
260 ' ROTINA DE LEITURA
280 FOR H=5 TO 11
290 E=49152!+(H-5)*512:E2=INT(E/256):E1=E-INT(E/256)*256
300 POKE &HF351,E1:POKE &HF352,E2
310 A$=DSKI$(ASC(I$)-64,H)
320 FOR G=0 TO 511 STEP 32
330 FOR F=0 TO 31
340 A$=A$+CHR$(PEEK(F+G+E))
350 NEXT
360 IF LEFT$(A$,1)=CHR$(0) THEN 440
370 IE A$>"a" OR A$<"A" THEN 420
390 N(S)=F+G+E-32
400 N$(S)=A$:K$=LEFT$(N$(S),8)+"."+MID$(N$(S),9,3)
410 IF S\2=S/2 THEN PRINT K$;"   SETOR:";USING "##";H ELSE PRINT K$;
420 A$=""
430 NEXT G,H
440 FOR F=1 TO 70:IF F\5=F/5 THEN BEEP
450 NEXT F
460 COLOR 15
470 KEY ON
480 K$=INKEY$:IF K$<>CHR$(13) THEN 480
490 KEY OFF
500 GOSUB 890:PRINTI$
520 ' ROTINA DE ORDENACAO
540 LOCATE 18,3:PRINT "ORDENACAO: CRESCENTE"
550 PRINT:PRINT
560 PRINT SPC(2);"EXECUTANDO ORDENACAO DO DIRETORIO"
570 FOR G=1 TO S-1
580 FOR F=G+1 TO S
590 IF N$(G)<N$(F) THEN 620
600 SWAP N$(G),N$(F)
610 Y=1
620 NEXT F
630 IF Y=1 THEN Y=0:NEXT G