00010 ' ====================================
00020 ' GAME LOOP 
00030 ' MANOEL NETO 2024
00040 ' ====================================
00050 COLOR 15,1,1
00060 KEY OFF:CLS:DEFINT A-Z
00070 DIM EX(4,3),EY(4,3)

00100 ' ************************************
00110 ' SPLASH SCREEN
00120 ' ************************************
00130 SCREEN 0
00140 LOCATE 14,10:? "SPACE INVADERS"
00150 LOCATE 10,12:? "PRESS FIRE TO START"
00160 LOCATE 12,14:? "MANOEL NETO 2024"
00170 OP$=INPUT$(1)

00200 ' ************************************
00210 ' INICIALIZA JOGO
00220 ' ************************************
00230 SCREEN 2,2,0
00240 RESTORE 9000
00245 GOSUB 5000 : ' TABELA DE SPRITES
00245 GOSUB 6000 : ' TABELA DE PADROES
00245 GOSUB 7000 : ' TABELA DE CORES 
00245 GOSUB 8000 : ' TABELA DE NOMES  
00250 ON SPRITE GOSUB 3000 :'COLISOES
00260 ON STRIG GOSUB 2000:' ADICIONA TORPEDO
00270 STRIG(0) ON
00280 X=127:Y=174:V=16 :'HEROI
00290 TX=0:TY=0:TV=16:TC=0 :'TORPEDO
00300 TIME=0:AN=2:CM=1:VX=1:VY=20
00310 FOR I = 0 TO 4
00320    FOR J = 0 TO 3
00330        EX(I,J)=16+J*20
00340        EY(I,J)=16+I*20
00350   NEXT J
00360 NEXT I

00400 ' ************************************
00410 ' ATUALIZA AS COORDENADAS       
00420 ' ************************************
00425 IF TC = 1 THEN GOSUB 1000:'TORPEDO
00430 FOR I = 0 TO 4
00440    FOR J = 0 TO 3
00450        EX(I,J)=EX(I,J)+VX
00460    NEXT J
00470 NEXT I
00480 IF EX(0,3)>=223 THEN 510 
00490 IF EX(0,0)<=16  THEN 510
00500 GOTO 600 : 'DESENHA O FRAME 
00510 ' INVERTE A DIRECAO DOS ALIENS
00520 VX=VX*-1
00530 FOR I = 0 TO 4
00540    FOR J = 0 TO 3
00550        EY(I,J)=EY(I,J)+VY
00560    NEXT J
00570 NEXT I

00600 ' ************************************
00610 ' DESENHA O FRAME               
00620 ' ************************************
00630 SPRITE OFF
00640   CM=1 : ' CAMADA DOS ALIENS
00650   PUT SPRITE 0,(X,Y),6,0 : 'CANHAO
00655   IF TC=1 THEN PUT SPRITE 21,(TX,TY),8,3 : 'TORPEDO
00660   FOR I = 0 TO 4 : 'ALIENS
00670     FOR J = 0 TO 3
00680       PUT SPRITE CM,(EX(I,J),EY(I,J)),3,AN
00690       CM=CM+1
00700     NEXT J
00710   NEXT I
00730 SPRITE ON
00740 IF TIME<2 GOTO 740
00750 IF AN=1 THEN AN=2 ELSE AN=1
00760 TIME=0 

00800 ' ************************************
00810 ' ENTRADA DO JOGADOR            
00820 ' ************************************
00830 S=STICK(0) 
00840 IF S = 3 THEN GOTO 870
00850 IF S = 7 THEN GOTO 880
00860 GOTO 920
00870 X=X+V:GOTO 920
00880 X=X-V:GOTO 920
00890 ' ************************************
00900 ' DETERMINA OS LIMITES DA TELA  
00910 ' ************************************
00920 IF X<0 THEN X=0
00930 IF X>239 THEN X=239
00940 GOTO 400

01000 ' ************************************
01010 ' MOVE O TORPEDO                 
01020 ' ************************************
01030 TY = TY - TV
01040 IF TY <= 0 THEN TY = -20:TC=0
01050 RETURN

02000 ' ************************************
02010 ' ADICIONA UM TORPEDO           
02020 ' ************************************
02030 IF TC = 1 THEN RETURN
02040 TC=1:TX=X:TY=Y-10
02050 RETURN

03000 ' ************************************
03010 ' TRATA AS COLISOES             
03020 ' ************************************
03030 SPRITE OFF
03040 COLOR 15,1,1
03050 SCREEN 0
03060 CLS
03070 GOTO 4000
03080 END

04000 ' ************************************
04010 ' FIM DO JOGO 
04020 ' ************************************
04030 PRINT "DESEJA JOGAR NOVAMENTE? (S/N)"
04040 OP$=INPUT$(1)
04050 IF OP$="S" OR OP$="s" THEN 200
04060 END

05000 ' ************************************
05010 ' CARREGA A TABELA DE SPRITES          
05020 ' ************************************
05030 S=BASE(9)
05040 READ R$
05050 IF R$="*" THEN RETURN 
05060 VPOKE S,VAL("&H"+R$)
05070 S=S+1
05060 GOTO 5040

06000 ' ************************************
06010 ' CARREGA A TABELA DE PADROES 
06020 ' ************************************
06030 S=0 
06040 READ R$
06050 IF R$="*" THEN RETURN 
06060 R=VAL("&H"+R$)
06070 VPOKE S,R
06080 VPOKE 2048+S,R
06090 VPOKE 4096+S,R
06100 S=S+1
06110 GOTO 6040

07000 ' ************************************
07010 ' CARREGA A TABELA DE CORES  
07020 ' ************************************
07030 S=0 
07040 READ R$
07050 IF R$="*" THEN RETURN 
07060 R=VAL("&H"+R$)
07070 VPOKE &H2000+S,R
07080 VPOKE &H2800+S,R
07090 VPOKE &H3000+S,R
07100 S=S+1
07110 GOTO 7040

08000 ' ************************************
08010 ' CARREGA A TABELA DE NOMES  
08020 ' ************************************
08030 S=&H1800
08040 READ R$
08050 IF R$="*" THEN RETURN 
08060 VPOKE S,VAL("&H"+R$)
08070 S=S+1
08090 GOTO 8040

09000 ' ************************************
09010 ' PADROES            
09020 ' ************************************
09030 ' CANHAO - COLOR 6
09040 DATA 00,00,00,00,00,00,01,01
09050 DATA 07,07,07,7F,FF,FF,FF,FF
09060 DATA 00,00,00,00,00,00,80,80
09070 DATA E0,E0,E0,FE,FF,FF,FF,FF
09080 ' TORPEDO - COLOR 8
09090 DATA 00,00,00,00,00,00,00,00
09100 DATA 00,01,01,01,01,01,01,01
09110 DATA 00,00,00,00,00,00,00,00
09120 DATA 00,80,80,80,80,80,80,80
09130 DATA *
09140 ' ALIEN 1-1 - COLOR 3
09150 DATA 00,01,07,1F,13,3F,7F,7E
09160 DATA 1C,18,20,30,18,0C,06,02
09170 DATA 00,80,E0,F8,C8,FC,FE,7E
09180 DATA 38,18,04,0C,18,30,60,40
09190 ' ALIEN 1-2 - COLOR 3
09200 DATA 00,01,07,1F,13,3F,7F,7F
09210 DATA 1F,03,06,0C,18,30,60,40
09220 DATA 00,80,E0,F8,C8,FC,FE,FE
09230 DATA F8,C0,60,30,18,0C,06,02
09240 DATA *